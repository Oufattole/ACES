predicates:
  hemoglobin:
    column: lab
    value: Hemoglobin (g/dl)
    system: count
  abnormal_value_1:
    column: valuenum
    value:
      - min: 17.2
    system: boolean
  abnormal_value_2:
    column: valuenum
    value:
      - max: 13.8
    system: boolean
  normal_value:
    column: valuenum
    value:
      - min: 13.8
      - max: 17.2
    system: boolean
  abnormal_hemoglobin_1:
    type: ALL
    predicates: [hemoglobin, abnormal_value_1]
    system: boolean
  abnormal_hemoglobin_2:
    type: ALL
    predicates: [hemoglobin, abnormal_value_2]
    system: boolean
  abnormal_hemoglobin:
    type: ANY
    predicates: [abnormal_hemoglobin_1, abnormal_hemoglobin_2]
    system: boolean
  normal_hemoglobin:
    type: ALL
    predicates: [hemoglobin, normal_value]
    system: boolean
  any: 
    type: special

windows:
  trigger:
    start: normal_hemoglobin
    duration:
    offset:
    end: normal_hemoglobin
    excludes:
    includes:
    st_inclusive: False
    end_inclusive: True
  gap:
    start: trigger.end
    duration: 24 hours
    offset:
    end:
    excludes:
    includes: 
    st_inclusive: False
    end_inclusive: True
  target:
    start: gap.end
    duration: 7 days
    offset:
    end: 
    excludes:
    includes: 
      - predicate: hemoglobin
        min: 1
    st_inclusive: False
    end_inclusive: True
    label: abnormal_hemoglobin
  input:
    start:
    duration: -30 days
    offset:
    end: trigger.start
    excludes:
    includes:
    st_inclusive: False
    end_inclusive: True
